# Решение тестового задания

Данный репозиторий содержит решение нескольких тестовых заданий. Каждое задание находится в отдельной папке.

---

## Подготовка проекта к работе

Перед запуском любого из скриптов необходимо выполнить следующие общие шаги:

1.  **Клонируйте репозиторий** на свою локальную машину:

    ```bash
    git clone github.com
    cd test-task-diamant-vision
    ```

2.  **Установите все необходимые зависимости** Python, перечисленные в файле `requirements.txt`, с помощью pip:

    ```bash
    pip install -r requirements.txt
    ```

После выполнения этих шагов можно переходить к инструкциям по запуску конкретных заданий ниже.

---

## Задание 1: Проверка email-доменов (Папка `first_task`)

### Описание

Скрипт на Python, который принимает список email-адресов в качестве аргументов командной строки, проверяет наличие MX-записей для домена каждого адреса и выводит его статус.

Скрипт находится по пути: `first_task/email_checker.py`.

### Используемые библиотеки

Для работы скрипта требуются библиотеки `email-validator` и `dnspython`.

### Инструкция по запуску

Выполните команду из **корневой папки** репозитория, передавая email-адреса как аргументы через пробел:
    ```
    python first_task/email_checker.py test@gmail.com example@domennotsuch.com invalid-email@test.com
    ```

### Пример вывода

test@gmail.com -> домен валиден
example@domennotsuch.com -> домен отсутствует
invalid-email@test.com -> MX-записи отсутствуют или некорректны

---

## Задание 2: Мини-интеграция с Telegram (Папка `second_task`)

### Описание

Скрипт на Python, который читает текст из локального файла (`message.txt`) и отправляет его в указанный приватный Telegram-чат через Telegram-бота.

Скрипт находится по пути: `second_task/telegram_sender.py`.

### Используемые библиотеки

Для работы скрипта требуется библиотека `requests`.

### Инструкция по запуску

1.  **Подготовка Telegram:**
    *   Получите **токен** вашего бота у `@BotFather`.
    *   Получите **ID чата/канала** (например, с помощью `@getmyid_bot`).
    *   *Важно:* Токен и ID должны быть прописаны в самом файле `second_task/telegram_sender.py` в соответствующих переменных `BOT_TOKEN` и `CHAT_ID`.

2.  **Подготовка файла с текстом:**
    *   Поместите файл `message.txt` в папку `second_task`.
    *   Убедитесь, что переменная `TEXT_FILE_PATH` в скрипте указывает на правильный путь к файлу.

3. **Запустите скрипт:**

    Выполните команду из **корневой папки** репозитория:

    ```bash
    python second_task/telegram_sender.py
    ```

### Пример вывода

После успешного выполнения в консоли появится сообщение:
Сообщение успешно доставлено.  А в вашем Telegram-чате появится текст из файла `message.txt`.

## Задача 3: Архитектурная задача 

Архитектура платформы для email-аутрича: 1200 адресов, высокая надежность и низкие затраты
Для обслуживания 1200 уникальных email-адресов в рамках аутрич-кампаний для нескольких клиентов критически важно соблюсти баланс между надежностью доставки и стоимостью инфраструктуры. Предлагаемая архитектура основана на использовании бессерверных технологий (Serverless) и проверенных облачных сервисов отправки почты.
Описание решения и используемые подходы
Ключевой принцип — минимальное администрирование и оплата по факту использования. Мы избегаем развертывания собственных серверов (виртуальных машин), а вместо этого используем функции облачного провайдера (например, AWS Lambda или Yandex Cloud Functions), которые запускаются по расписанию.
Для хранения всех данных (списки адресов, шаблоны, логи отправки, статусы клиентов) используется управляемая реляционная база данных, такая как PostgreSQL. Это надежное решение, которое избавляет нас от забот по резервному копированию и обслуживанию СУБД.
Отправка писем — самая важная часть. Вместо того чтобы поднимать свой SMTP-сервер (что чревато проблемами с репутацией IP и блокировками), мы делегируем эту задачу специализированному сервису, например, AWS Simple Email Service (SES). Он гарантирует высокую доставляемость благодаря пулу "прогретых" IP-адресов и автоматически обрабатывает служебные сообщения (отказы доставки, жалобы на спам).
Чтобы сгладить нагрузку и обеспечить отказоустойчивость, между планировщиком задач и отправкой в SES используется промежуточный буфер — очередь сообщений (например, AWS SQS).
Ротация, нагрузка и мониторинг
Распределение нагрузки происходит автоматически благодаря Serverless-модели: когда нужно отправить больше писем, облачный провайдер масштабирует количество запущенных функций Lambda параллельно. Каждая функция берет из очереди небольшой батч заданий и выполняет его.
Ротация адресов реализуется через логику в самом коде и базе данных. Мы храним метки времени последнего использования для каждого из 1200 адресов. Запрос к базе данных выбирает адреса, которые дольше всего "отдыхали", обеспечивая равномерное использование всего пула и снижая риск попасть в спам-фильтры из-за перегрузки одного адреса.
Мониторинг — наша страховка. Мы используем встроенные инструменты облака (например, AWS CloudWatch) для отслеживания ошибок выполнения кода. Главный акцент делается на мониторинге репутации в SES. Критически важно контролировать процент отказов (bounce rate) и жалоб (complaint rate), чтобы автоматически исключать "плохие" адреса из рассылки и поддерживать репутацию на высоком уровне.
Риски и стоимость
Основной риск — это блокировка аккаунта или снижение доставляемости из-за жалоб. Мы закрываем его использованием профессионального сервиса SES, который берет на себя управление IP-репутацией и автоматически обрабатывает обратную связь.
С точки зрения стоимости, архитектура крайне выгодна. Основные траты приходятся на небольшой управляемый экземпляр базы данных (около $15 в месяц). Отправка писем и выполнение кода на Serverless-функциях обойдутся в считанные доллары (примерно $3–5 в месяц при указанных объемах), так как оплата взимается только за фактический трафик и время работы.
Общая примерная стоимость эксплуатации такой системы составит менее 20 долларов США в месяц, что значительно ниже затрат на традиционные серверные решения.